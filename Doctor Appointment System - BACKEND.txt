Doctor Appointment System â€“ Backend Documentation

Tech Stack: Node.js, Express.js, MongoDB, Mongoose, JWT, bcrypt
Roles: User & Admin
Core Modules: Authentication, Doctor Management, Appointment Management, User Management

ğŸ—‚ï¸ 1. Backend Folder Structure
backend/
â”‚â”€â”€ server.js
â”‚â”€â”€ package.json
â”‚â”€â”€ .env
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js
â”‚
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ authController.js
â”‚   â”œâ”€â”€ userController.js
â”‚   â”œâ”€â”€ adminController.js
â”‚   â”œâ”€â”€ doctorController.js
â”‚   â””â”€â”€ appointmentController.js
â”‚
â”œâ”€â”€ middlewares/
â”‚   â”œâ”€â”€ authMiddleware.js
â”‚   â””â”€â”€ adminMiddleware.js
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js
â”‚   â”œâ”€â”€ Admin.js
â”‚   â”œâ”€â”€ Doctor.js
â”‚   â”œâ”€â”€ Appointment.js
â”‚   â””â”€â”€ TokenBlacklist.js (optional logout)
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ authRoutes.js
â”‚   â”œâ”€â”€ userRoutes.js
â”‚   â”œâ”€â”€ adminRoutes.js
â”‚   â”œâ”€â”€ doctorRoutes.js
â”‚   â””â”€â”€ appointmentRoutes.js
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ generateToken.js
    â””â”€â”€ sendEmail.js (optional)

ğŸ”§ 2. Server Configuration
File: server.js

Loads environment variables

Connects to MongoDB

Applies global middlewares

Registers API routes

Starts Express server

ğŸ§© 3. Config Module
db.js

Purpose:

Connect to MongoDB using mongoose

Retry logic for failed attempts

ğŸ” 4. Authentication & Authorization
JWT Authentication

Users & Admins login using JWT

Token stored in client localStorage

Every protected API request must include:

Authorization: Bearer <token>

ğŸ” 4.1 Middlewares
authMiddleware.js

Used for User authentication.

Responsibilities:

Validate JWT

Extract user ID

Attach user object to req.user

Allow only authenticated users

Used in routes like:

/api/user/profile

/api/appointments/book

adminMiddleware.js

Used for Admin-only access.

Responsibilities:

Validate JWT

Verify the â€œadminâ€ role

Allow only admins to proceed

Used in:

/api/admin/dashboard

/api/admin/doctor

ğŸ“¦ 5. Models Documentation
5.1 User Model

Fields:

name
email
phone
password (hashed)
age
gender
role = "user"
createdAt

5.2 Admin Model

Fields:

email
password (hashed)
role = "admin"
createdAt

5.3 Doctor Model

Fields:

name
email
specialization
experience
fees
timings
image
createdAt

5.4 Appointment Model

Fields:

userId
doctorId
date
time
status  -> pending | approved | cancelled
createdAt

ğŸ§  6. Controllers Documentation
6.1 Auth Controller
User Registration
POST /api/auth/register


Validates:

name

email

password

phone

Encrypts password with bcrypt â†’ saves user â†’ returns JWT.

User Login
POST /api/auth/login


Checks:

email exists

password matches

returns token + user details

Admin Login
POST /api/admin/login


Separate login for admins.

Validations:

Admin exists

Password correct

JWT returned

6.2 User Controller
Get User Profile
GET /api/user/profile


Needs authMiddleware

Returns user info

Update User Profile
PUT /api/user/profile


Editable:

name

phone

email

6.3 Doctor Controller
Get All Doctors
GET /api/doctors

Get Single Doctor
GET /api/doctors/:id

Admin â€“ Add Doctor
POST /api/admin/doctor

Admin â€“ Update Doctor
PUT /api/admin/doctor/:id

Admin â€“ Delete Doctor
DELETE /api/admin/doctor/:id

6.4 Appointment Controller
User â€“ Book Appointment
POST /api/appointments/book


Validations:

Check slot availability

Check doctor exists

Save appointment

User â€“ Get Appointments
GET /api/appointments/user

User â€“ Cancel Appointment
PUT /api/appointments/cancel/:id

Admin â€“ View All Appointments
GET /api/admin/appointments

Admin â€“ Approve Appointment
PUT /api/admin/appointment/approve/:id

Admin â€“ Reject Appointment
PUT /api/admin/appointment/reject/:id

6.5 Admin Controller
Dashboard Stats
GET /api/admin/dashboard


Returns:

totalUsers

totalDoctors

totalAppointments

pendingAppointments

Get All Users
GET /api/admin/users

Admin Profile
GET /api/admin/profile
PUT /api/admin/profile

ğŸ”„ 7. API Routes Summary
â­ User Routes
Method	Endpoint	Description
POST	/api/auth/register	User registration
POST	/api/auth/login	User login
GET	/api/user/profile	Get user profile
PUT	/api/user/profile	Update profile
GET	/api/doctors	View all doctors
GET	/api/doctors/:id	View doctor details
POST	/api/appointments/book	Book appointment
GET	/api/appointments/user	Get user appointments
PUT	/api/appointments/cancel/:id	Cancel appointment
â­ Admin Routes
Method	Endpoint	Description
POST	/api/admin/login	Admin login
GET	/api/admin/dashboard	Dashboard analytics
GET	/api/admin/users	All registered users
GET	/api/admin/doctors	All doctors
POST	/api/admin/doctor	Add doctor
PUT	/api/admin/doctor/:id	Edit doctor
DELETE	/api/admin/doctor/:id	Delete doctor
GET	/api/admin/appointments	All appointments
PUT	/api/admin/appointment/approve/:id	Approve appointment
PUT	/api/admin/appointment/reject/:id	Reject appointment
GET	/api/admin/profile	Admin profile
PUT	/api/admin/profile	Update admin profile
ğŸ›¡ï¸ 8. Security Features

Password encryption using bcryptjs

JWT-based secure authentication

Protected routes for user/admin

Role-based access control

Validation for duplicate users/admins

Appointment conflict check

ğŸ” 9. Environment Variables (.env)
PORT=5000
MONGO_URI=mongodb+srv://...
JWT_SECRET=your_jwt_secret
CORS_ORIGIN=http://localhost:3000

ğŸ› ï¸ 10. Install & Run
Install dependencies:
npm install

Start server:
npm start